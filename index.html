<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>Toxic</title>

  <link rel="stylesheet" href="main.css" />

  <!-- Telegram Mini Apps SDK (safe in regular browser too) -->
  <script src="https://telegram.org/js/telegram-web-app.js?59"></script>
</head>
<body class="theme-toxic">

  <!-- LOADING -->
  <div id="loadingScreen" class="screen active" aria-label="Загрузка">
    <div class="panel">
      <h1 id="logoText" class="logoGlitch" data-text="Toxic">Toxic</h1>
      <p class="hint">Приготовься к испытанию!</p>

      <div class="loadbar" aria-label="Прогресс загрузки">
        <div id="loadbarFill" class="loadbar__fill"></div>
      </div>
      <div id="loadingTip" class="hint">Разогреваем токсичность…</div>
    </div>
  </div>

  <!-- LEVEL SELECT -->
  <div id="levelScreen" class="screen" aria-label="Выбор уровня">
    <div class="panel">
      <h2>Выбери уровень сложности</h2>
      <div class="levelButtons">
        <button type="button" data-level="easy">Лёгкий</button>
        <button type="button" data-level="medium">Средний</button>
        <button type="button" data-level="hard">Сложный</button>
        <button type="button" data-level="insane">Безумие</button>
      </div>

      <div class="row">
        <button id="openLeaderboardBtn" type="button" class="secondary">Лидерборд</button>
      </div>
    </div>
  </div>

  <!-- PREP -->
  <div id="prepScreen" class="screen" aria-label="Подготовка">
    <div class="panel">
      <p id="prepMessage">Готов? Уровень: <span id="selectedLevel">Лёгкий</span></p>
      <div class="row">
        <button id="startGameBtn" type="button">Ладно, я попробую</button>
        <button id="backToLevelsBtn" type="button" class="secondary">Назад</button>
      </div>
    </div>
  </div>

  <!-- GAME -->
  <div id="gameScreen" class="screen" aria-label="Игра">
    <div class="hud">
      <div id="scoreText">Очки: 0</div>
      <div id="levelText">Уровень: Лёгкий</div>
      <div id="timerText">Время: 0.00s</div>
    </div>

    <div id="gameArea" class="game-area" aria-label="Игровое поле"></div>

    <div id="toast" class="toast" aria-live="polite"></div>
  </div>

  <!-- RESULT -->
  <div id="resultScreen" class="screen" aria-label="Результат">
    <div class="panel">
      <h2 id="resultText"></h2>
      <p id="demotivatorText" class="hint"></p>

      <div class="row">
        <button id="retryBtn" type="button">Ещё раз</button>
        <button id="levelsBtn" type="button" class="secondary">Уровни</button>
      </div>

      <div class="row">
        <button id="saveRunBtn" type="button">Сохранить в лидерборд</button>
        <button id="openLeaderboardBtn2" type="button" class="secondary">Открыть лидерборд</button>
      </div>

      <p class="small hint">
        Лидерборд сейчас локальный (на устройстве). Глобальный (общий) — можно добавить через бэкенд/API.
      </p>
    </div>
  </div>

  <!-- LEADERBOARD -->
  <div id="leaderboardScreen" class="screen" aria-label="Лидерборд">
    <div class="panel wide">
      <div class="lbHeader">
        <h2>Лидерборд</h2>
        <button id="closeLeaderboardBtn" type="button" class="secondary">Закрыть</button>
      </div>

      <div class="lbControls">
        <label class="lbLabel">
          Уровень:
          <select id="lbLevelSelect">
            <option value="easy">Лёгкий</option>
            <option value="medium">Средний</option>
            <option value="hard">Сложный</option>
            <option value="insane">Безумие</option>
          </select>
        </label>
        <button id="clearLbBtn" type="button" class="danger">Очистить</button>
      </div>

      <div class="lbTableWrap">
        <table class="lbTable" aria-label="Таблица лидеров">
          <thead>
            <tr>
              <th>#</th>
              <th>Имя</th>
              <th>Очки</th>
              <th>Средн. реакция</th>
              <th>Время раунда</th>
              <th>Дата</th>
            </tr>
          </thead>
          <tbody id="lbBody"></tbody>
        </table>
      </div>

      <p class="small hint">
        Подсказка: в Telegram мы подхватим имя из профиля. В браузере можно задать его при сохранении.
      </p>
    </div>
  </div>

  <script src="engine.js"></script>
</body>
</html>
